# 基于多元组提高射频仿真角度精度的方法

唐波，盛新庆，金从军，赵小阳

---

## 背景

射频仿真的经典结构是三元组结构，是由波音公司提出的同时使用3个辐射单元仿真一个点目标的结构。三元组的工作原理与多干扰辐射单元在多通道雷达中生成虚假目标信号的原理相似，不过三元组是合作目标，虚假目标信号是非合作目标。

射频仿真系统核心功能是精确模拟散射回波的方向，仿真角度误差是重要的性能参数。其产生原因多种多样，包括幅度相位误差、近场误差、转台误差等。

仿真角度误差分为随机误差和系统误差，随机误差通过提高幅度相位控制精度改进，系统误差通过系统矫正、近场修正改进。

当角度精度提高到一定程度后，再提升传统的三元组系统的角度精度会变得相当困难，由此想到引入多个辐射单元构成多元组抑制随机误差，提高角度精度。直观来想，引入更多的辐射单元应该会带来更多的误差是的误差传递系数更大，而且会引入更多系统冗余，文章采用优化方法求解个辐射单元的最优幅度取值，达到抑制角度误差的目的，==（尽管与理论猜想不符，）==实验结果表明多元组能够提高角度精度。

---

## 多元组的辐射单元幅度计算

射频仿真的关键一步是计算出各单元幅度

设三元组的3个辐射单元方向为$(\Theta_1,\Phi_1)$、$(\Theta_2,\Phi_2)$、$(\Theta_3,\Phi_3)$，其中$\Theta_i$趋于零，三元组仿真的点目标方向为$(\Theta_0,\Phi_0)$，记
$$
X=\sin\Theta_0\cos\Phi_0\quad (1)\\
Y=\sin\Theta_0\sin\Phi_0\quad (2)\\
X_i=\sin\Theta_i\cos\Phi_i\quad (3)\\
Y_i=\sin\Theta_i\sin\Phi_0\quad (4)
$$
由幅度重心公式，有
$$
X=\sum_{i=1}^NC_iX_i\quad (5)\\
Y=\sum_{i=1}^NC_iY_i\quad (6)
$$
其中的$C_i$为第$i$个辐射单元的幅度，为便于分析，大部分文献中令
$$
\sum_{i=1}^NC_i=1\quad (7)
$$
其中$N$表示$N$元组，对三元组有==此处推导见多目标半实物射频仿真系统的仿真误差简要分析--唐波==
$$
\left[
\begin{matrix}
C_1\\C_2\\C_3
\end{matrix}
\right]
=\left[\begin{matrix}
\lvert
\begin{matrix}
X-X_2\quad X-X_3\\
Y-Y_2\quad Y-Y_3 
\end{matrix}
\rvert
\\
\lvert
\begin{matrix}
X-X_3\quad X-X_1\\
Y-Y_3\quad Y-Y_1
\end{matrix}
\rvert\\
\lvert
\begin{matrix}
X-X_1\quad X-X_2\\
Y-Y_1\quad Y-Y_2
\end{matrix}
\rvert
\end{matrix}\right] /Q\quad (8)\\
Q=\lvert\begin{matrix}
X-X_2\quad X-X_3\\Y-Y_2\quad Y-Y_3
\end{matrix}\rvert
+
\lvert\begin{matrix}
X-X_3\quad X-X_1\\Y-Y_3\quad Y-Y_1
\end{matrix}\rvert
+
\lvert\begin{matrix}
X-X_1\quad X-X_2\\Y-Y_1\quad Y-Y_2
\end{matrix}\rvert\quad (9)
$$
仿真角度误差为
$$
\Delta X=\sum_{i=1}^3(X_i-X)\Delta C_i\quad (10)\\
\Delta Y=\sum_{i=1}^3(Y_i-Y)\Delta C_i\quad (11)
$$
多元组中幅度未知数个数多于方程个数，故解不唯一，为了获得$C_i$定解，需要考察取值对误差传递的影响，$N$元组仿真角度误差一般表示为
$$
\Delta X=\sum_{i=1}^N(X_i-X)\Delta C_i\quad (12)\\
\Delta Y=\sum_{i=1}^N(Y_i-Y)\Delta C_i\quad(13)
$$
数学直觉上来说多元组中求和项增多，结构尺寸变大，误差传递系数也应该变大，会导致总误差变大，但事实上由于$C_i$解不唯一，可以通过选取合适的$C_i$取值充分利用多元组冗余特性，使误差优于三元组

已知幅度误差方差$D(\Delta C_i)=\gamma C_i^2$，式中$\gamma$是幅度误差常系数，那么两个方向仿真角度误差方程分别为
$$
D(\Delta X)=D(\sum_{i=1}^N(X_i-X)\Delta C_i)=D(\sum_{i=1}^N(X_i-X))D(\Delta C_i)\\
=\sum_{i=1}^N(X_i-X)^2 \gamma C^2_i\quad (14)\\
D(\Delta Y)=D(\sum_{i=1}^N(Y_i-Y)\Delta C_i)=D(\sum_{i=1}^N(Y_i-Y))D(\Delta C_i)\\
=\sum_{i=1}^N(Y_i-Y)^2 \gamma C^2_i\quad (15)
$$
则仿真角度误差可表示为
$$
D=D(\Delta X)+D(\Delta Y)=\sum_{i=1}^N[(X_i-X)^2+(Y_i-Y)^2]\gamma C_i^2\quad (16)
$$
现在问题转化成了优化问题
$$
s.t. (5)\sim(7)\\
\arg \min D=\sum_{i=1}^N[(X_i-X)^2+(Y_i-Y)^2]\gamma C_i^2
$$
使用拉格朗日乘数法，构造拉格朗日函数为
$$
f(C_i,\lambda_X,\lambda_Y,\lambda_1)=\eta^2\sum_{i=1}^N[(X_i-X)^2+(Y_i-Y)^2]C^2_i+\\\lambda_X[\sum_{i=1}^NC_i(X_i-X)]+\lambda_Y[\sum_{i=1}^NC_i(Y_i-Y)]+\lambda_1(\sum_i=1^NC_i-1)\quad(17)
$$
其中$\lambda_X$、$\lambda_Y$、$\lambda_1$都是拉格朗日乘数，上式对$C_i$求导，令结果为0，得
$$
\{[(X_i-X)^2+(Y_i-Y)^2]C_i+\lambda_X(X_i-X)+\lambda_Y(Y_i-Y)+\lambda_1\}=0\quad (18)
$$
注其中$i=1,2,...,N$，故实际上是方程组，方程组与式(5)~(7)联立，共计$N+3$个方程和$N+3$个未知数，可以求解得
$$
C_i=\frac{1}{p_i}[u_i,v_i,1]\bold{W}^{-1}\left[\begin{matrix}0\\0\\1\end{matrix}\right]\quad (19)
$$
式中，$p_i=u_i^2+v_i^2$，$u_i=X_i-X$，$v_i=Y_i-Y$
$$
\bold{W}=\left[\begin{matrix}
\sum_{i=1}^Np_i^{-1}u_i^2\quad \sum_{i=1}^Np_i^{-1}u_iv_i\quad \sum_{i=1}^Np_i^{-1}u_i\\
\sum_{i=1}^Np_i^{-1}u_iv_i\quad \sum_{i=1}^Np_i^{-1}v_i^2\quad \sum_{i=1}^Np_i^{-1}v_i\\
\sum_{i=1}^Np_i^{-1}u_i\quad \sum_{i=1}^Np_i^{-1}v_i\quad \sum_{i=1}^Np_i^{-1}
\end{matrix}\right]
$$
由$\bold{W}^{-1}=\frac{1}{|\bold{W}|}\bold{W}^*$，进一步展开式(19)
$$
\bold{W}^{-1}\left[\begin{matrix}
0\\0\\1
\end{matrix}\right]=
\frac{1}{|\bold{W}|}
\left[\begin{matrix}
\sum_{i=1}^Np_i^{-1}u_i^2\quad \sum_{i=1}^Np_i^{-1}u_iv_i\quad \sum_{i=1}^Np_i^{-1}u_i\\
\sum_{i=1}^Np_i^{-1}u_iv_i\quad \sum_{i=1}^Np_i^{-1}v_i^2\quad \sum_{i=1}^Np_i^{-1}v_i\\
\sum_{i=1}^Np_i^{-1}u_i\quad \sum_{i=1}^Np_i^{-1}v_i\quad \sum_{i=1}^Np_i^{-1}
\end{matrix}\right]^*
\left[\begin{matrix}
0\\0\\1
\end{matrix}\right]
\\
=\frac{1}{|\bold{W}|}
\left[\begin{matrix}
\lvert\begin{matrix}
\sum_{i=1}^Np_i^{-1}u_iv_i\quad \sum_{i=1}^Np_i^{-1}v_i^2\\
\sum_{i=1}^Np_i^{-1}u_i\quad \sum_{i=1}^Np_i^{-1}v_i
\end{matrix}\rvert\\
\lvert\begin{matrix}
\sum_{i=1}^Np_i^{-1}u_iv_i\quad \sum_{i=1}^Np_i^{-1}u_i^2\\
\sum_{i=1}^Np_i^{-1}v_i\quad \sum_{i=1}^Np_i^{-1}u_i
\end{matrix}\rvert\\
\lvert\begin{matrix}
\sum_{i=1}^Np_i^{-1}u_i^2\quad \sum_{i=1}^Np_i^{-1}u_iv_i\\
\sum_{i=1}^Np_i^{-1}u_iv_i\quad \sum_{i=1}^Np_i^{-1}v_i^2
\end{matrix}\rvert
\end{matrix}\right]
\\C_i=\frac{1}{p_i|\bold{W}|}u_i\lvert\begin{matrix}
\sum_{i=1}^Np_i^{-1}u_iv_i\quad \sum_{i=1}^Np_i^{-1}v_i^2\\
\sum_{i=1}^Np_i^{-1}u_i\quad \sum_{i=1}^Np_i^{-1}v_i
\end{matrix}\rvert
\\+
v_i\lvert\begin{matrix}
\sum_{i=1}^Np_i^{-1}u_iv_i\quad \sum_{i=1}^Np_i^{-1}u_i^2\\
\sum_{i=1}^Np_i^{-1}v_i\quad \sum_{i=1}^Np_i^{-1}u_i
\end{matrix}\rvert
+
\lvert\begin{matrix}
\sum_{i=1}^Np_i^{-1}u_i^2\quad \sum_{i=1}^Np_i^{-1}u_iv_i\\
\sum_{i=1}^Np_i^{-1}u_iv_i\quad \sum_{i=1}^Np_i^{-1}v_i^2
\end{matrix}\rvert\quad (20)
$$
此为幅度解，将上述$C_i$代入式(16)可得角度误差的方差
$$
D=\gamma\sum_{i=1}^N\frac{1}{p_i}\{[u_i,v_i,1]W\left[\begin{matrix}0\\0\\1\end{matrix}\right] \}^2\quad (21)
$$

---

## 多元组角度误差的数值分析

计算参数设置如下：相邻单元相对于传感器的张角为24mrad，幅度误差常系数$\gamma$设为0.01，由式(21)可知，方差与$\gamma$是简单线性关系，误差的减小倍数与$\gamma$无关，仅与单元数以及空间结构有关。根据图3-图5，可知实验结果中随着多元组中单元数增多，角度误差的方差呈下降趋势，图像更为平滑

---

## 多元组的近场修正

三元组中存在近场效应(近场效应详情参考射频仿真中的双近场效应--陈训达)，多元组中仍然存在近场效应，我们需要重新审视近场效应修正流程。==近场修正的关键就是修正量的计算==

先看三元组的修正：

1. 给出相同仿真环境下真实口径传感器的测量角与口径为$0$的理想传感器的测量角之间的角度差，此角度差为需要修正的角度。
2. 在仿真时，由需要仿真的真实口径传感器的侧角以及对应角度差，得到口径为$0$的理想传感器的测量角，再由幅度重心公式得到幅度

对于多元组来说，最后不由幅度重心公式得到幅度，而是利用上述式(20)求解幅度。

此外，尽管流程相同，但是获得角度修正量的方法不同，三元组中采用调整幅度的方法获得，多元组中单元数量多，调整幅度复杂性过大，采用如下方法获取：

给定一个口径趋于零的传感器的测量角$\Omega_0=(X_0,Y_0)$，由该角度代入式(20)计算幅度，由幅度$C_i$通过电磁数值计算方法获得真是口径传感器测量角度$\Omega=(X,Y)$，角度修正量为$\Delta \Omega=\Omega_0-\Omega$，此为$X_0,Y_0$的函数，这样能够获得角度修正表。当$\Omega_0$为均匀采样时，$\Omega$往往是非均匀的，通过插值方法使得$\Omega$变成均匀采样，然后输入到修正表，$\Omega\rightarrow \Delta \Omega\rightarrow \Omega_0\rightarrow C_i$，即可获得近场修正后的多元组幅度

